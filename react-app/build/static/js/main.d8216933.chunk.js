(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{100:function(e,t,s){},101:function(e,t,s){},102:function(e,t,s){},103:function(e,t,s){},104:function(e,t,s){},105:function(e,t,s){},107:function(e,t,s){},108:function(e,t,s){},109:function(e,t,s){},114:function(e,t,s){},115:function(e,t,s){"use strict";s.r(t);var c=s(1),n=s.n(c),a=s(21),i=s.n(a),o=s(2),l=(s(64),s(6)),r=s(7);const d="session/SET_USER",j="session/REMOVE_USER",u="session/UPDATE_USER",b=e=>({type:d,payload:e}),h={user:null},p=(e,t)=>async s=>{const c=await fetch("/api/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(c.ok){const e=await c.json();return s(b(e)),null}if(!(c.status<500))return["An error occurred. Please try again."];{const e=await c.json();if(e.errors)return e.errors}},m=()=>async e=>{(await fetch("/api/auth/logout/",{headers:{"Content-Type":"application/json"}})).ok&&e({type:j})};var O=s(32),f=s.n(O),g=s(24),x=s.n(g);function v(e){return e.sort(((e,t)=>Date.parse(t.createdAt)>Date.parse(e.createdAt)?1:Date.parse(e.createdAt)>Date.parse(t.createdAt)?-1:0))}const w=e=>{const t=Date.now()-Date.parse(e),s=Math.floor(t/1e3),c=Math.floor(s/60),n=Math.floor(c/60),a=Math.floor(n/24),i=Math.floor(a/30),o=Math.floor(a/365);return s<=0?"0 seconds ago":1===s?"1 second ago":c<1?s+" seconds ago":1===c?"1 minute ago":n<1?c+" minutes ago":1===n?"1 hour ago":a<1?n+" hours ago":1===a?"1 day ago":i<1?a+" days ago":1===i?"1 month ago":o<1?i+" months ago":1===o?"1 year ago":o+" years ago"},y=e=>e.reduce(((e,t)=>(t.timeElapsed=w(t.createdAt),e[t.id]=t,e[t.id].comments={...k(t.comments)},e[t.id].postLikes={...k(t.postLikes)},e)),{}),N=e=>Object.values(e).reduce(((e,t)=>(t.timeElapsed=w(t.createdAt),e[t.id]=t,e[t.id].comments={...S(t.comments)},e[t.id].postLikes={...S(t.postLikes)},e)),{}),S=e=>Object.values(e).reduce(((e,t)=>(t.timeElapsed=w(t.createdAt),e[t.id]=t,e)),{}),k=e=>e.reduce(((e,t)=>(t.timeElapsed=w(t.createdAt),e[t.id]=t,e)),{}),E="posts/ADD_POST",I="posts/LOAD_POSTS",C="posts/LOAD_ADDITIONAL_POSTS",L="posts/REMOVE_POST",_="comments/ADD_COMMENT",T="comments/REMOVE_COMMENT",D="likes/ADD_LIKE",U="likes/REMOVE_LIKE",A=e=>({type:E,post:e}),P=e=>({type:I,posts:e}),M=e=>({type:C,posts:e}),R=e=>({type:_,comment:e}),F=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"feed",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return async c=>{let n;if("feed"===e){if(n=await fetch("/api/posts/pages/".concat(s,"/")),n.ok){const e=await n.json();return c(1===s?P(e):M(e)),e}}else"profile"===e&&(n=await fetch("/api/users/".concat(t,"/posts/")));if(n.ok){const e=await n.json();return c(P(e)),e}}},q=e=>async t=>{const s=await fetch("/api/posts/".concat(e,"/"),{method:"DELETE"});if(s.ok){const e=await s.json();if(e)return await t((e=>({type:L,postId:e}))(e)),e}},z=(e,t)=>async s=>{const c=await fetch("/api/posts/".concat(t,"/comments/").concat(e,"/"),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(c.ok){const e=await c.json();return s(((e,t)=>({type:T,postId:e,commentId:t}))(t,e)),{postId:t,commentId:e}}},B=e=>async t=>{const s=await fetch("/api/posts/".concat(e,"/like/"),{method:"PUT",headers:{"Content-Type":"application/json"}});if(s.ok){const e=await s.json();return"deleted"===e.status?t(((e,t)=>({type:U,postId:e,likeId:t}))(e.postId,e.likeId)):t({type:D,like:e}),e}};var H=function(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case E:{const e={...t};return s.post.timeElapsed=w(s.post.createdAt),s.post.comments.forEach((e=>{e.timeElapsed=w(e.createdAt)})),e[s.post.id]={...s.post},e}case I:return{...y(s.posts)};case C:return{...t,...y(s.posts)};case L:return e={...N(t)},delete e[s.postId],e;case _:{const e=s.comment.postId;return s.comment.timeElapsed=w(s.comment.createdAt),{...t,[e]:{...t[e],comments:{...t[e].comments,[s.comment.id]:s.comment}}}}case T:return e={...t,[s.postId]:{...t[s.postId],comments:{...t[s.postId].comments}}},delete e[s.postId].comments[s.commentId],e;case D:{const e=s.like.postId;return{...t,[e]:{...t[e],postLikes:{...t[e].postLikes,[s.like.id]:s.like}}}}case U:return e={...t,[s.postId]:{...t[s.postId],postLikes:{...t[s.postId].postLikes}}},delete e[s.postId].postLikes[s.likeId],e;default:return t}},W=(s(88),s(0));function J(){const e=Object(o.useDispatch)(),t=Object(r.g)(),[s,n]=Object(c.useState)(""),[a,i]=Object(c.useState)(),[l,d]=Object(c.useState)(!1),[j,u]=Object(c.useState)([]);Object(c.useEffect)((()=>{const e=[];s.length>255&&e.push("Caption must be less than 255 characters"),a||e.push("Please choose an image first before uploading."),u(e)}),[s,a]);const b=async e=>{if(!e)return console.log("upload a file first");const t=new FormData;t.append("file",e);return(await f.a.post("/api/s3/upload/",t)).data};return Object(W.jsxs)("div",{id:"post-upload",children:[Object(W.jsxs)("form",{onSubmit:async c=>{if(c.preventDefault(),j.length)return d(!0);e(Object(g.showLoading)());const n=await b(a);e((e=>async t=>{const s=await fetch("/api/posts/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t(A(e)),e}})({caption:s,postImageUrl:n})).then((async s=>(e(Object(g.hideLoading)()),window.scrollTo({top:0,left:0,behavior:"smooth"}),t.push("/")))).catch((async e=>{console.log(e);const t=await e.json();t&&t.errors&&(u(t.errors),d(!0))}))},id:"post-form",children:[Object(W.jsx)(x.a,{style:{backgroundColor:"var(--color-apricot)",height:"12px",maxWidth:"500px",position:"absolute",top:"0",left:"0",right:"0",margin:"0 auto"},updateTime:100,progressIncrease:5,maxProgress:95}),Object(W.jsxs)("div",{id:"upload-and-preview-section",children:[Object(W.jsx)("div",{id:"preview",style:j.includes("Please choose an image first before uploading.")&&l?{border:"1.4px solid red"}:{},children:a&&Object(W.jsx)("img",{src:URL.createObjectURL(a),alt:"preview",id:"image-preview"})}),Object(W.jsxs)("div",{id:"upload",children:[Object(W.jsx)("label",{htmlFor:"img",id:"select-file-button",children:"SELECT IMAGE"}),Object(W.jsx)("input",{type:"file",id:"img",name:"img",accept:"image/*",onChange:e=>i((()=>e.target.files[0])),hidden:!0})]})]}),Object(W.jsxs)("div",{className:"upload__bottom",children:[Object(W.jsx)("textarea",{type:"text",id:"caption",className:j.includes("Caption must be less than 255 characters")?"red-outline":"",rows:4,placeholder:"enter a caption...",name:"caption",value:s,onChange:e=>n(e.target.value)}),Object(W.jsxs)("small",{className:"character-count",style:s.length>255?{color:"red"}:{},children:[s.length,"/255"]}),Object(W.jsxs)("div",{className:"upload-button-container",children:[Object(W.jsx)("button",{type:"submit",id:"upload-button",children:"UPLOAD"}),Object(W.jsx)("button",{type:"button",id:"cancel-button",onClick:e=>{window.confirm("Are you sure you want to cancel your upload?")&&(window.scrollTo({top:0,left:0,behavior:"smooth"}),t.push("/"))},children:"CANCEL"})]})]})]}),l?Object(W.jsx)("div",{className:"error-container",children:j.map((e=>Object(W.jsx)("div",{children:e},e)))}):null]})}s(51);var G=s(4),V=s(5),K=s(18);s(91);function Y(e){let{children:t,closeModal:s}=e;return i.a.createPortal(Object(W.jsxs)("div",{id:"modal",children:[Object(W.jsx)("div",{id:"modal_background",onClick:s}),Object(W.jsx)("div",{id:"modal_content",children:t})]}),document.getElementById("portal"))}var Q=s.p+"static/media/default-profile-image.1d0c42d3.png";s(92);function Z(e){let{user:t}=e;const s=Object(r.g)();return Object(W.jsx)("div",{className:"profile-icon-border",onClick:e=>(window.scrollTo({top:0,left:0,behavior:"smooth"}),s.push("/".concat(t.handle))),children:Object(W.jsx)("img",{className:"profile-icon",src:"/default-profile-image.png"!==t.profileImageUrl?t.profileImageUrl:Q,alt:"profile preview"})})}s(93),s(94);var X=function(e){let{comment:t,setShowEdit:s}=e;const n=Object(o.useDispatch)(),[a,i]=Object(c.useState)(t.content),[l,r]=Object(c.useState)([]);return Object(c.useEffect)((()=>{const e=[];a.length||e.push("!length"),a.length>255&&e.push("length>255"),r(e)}),[a]),Object(W.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),l.length)return;const c={id:t.id,content:a,postId:t.postId};n((e=>async t=>{const s=await fetch("/api/posts/".concat(e.postId,"/comments/").concat(e.id,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t(R(e)),e}})(c)).then((e=>{s(!1)})).catch((async e=>{const t=await e.json();t&&t.errors&&r(t.errors)}))},className:"edit-comment-form",children:[Object(W.jsx)("textarea",{type:"text",id:"edit-comment-input",name:"content",value:a,style:a.length>255||0===a.length?{borderColor:"red"}:{},onChange:e=>i(e.target.value)}),Object(W.jsxs)("div",{id:"edit-comment-button-container",children:[Object(W.jsxs)("small",{style:a.length>255||0===a.length?{color:"red"}:{},children:[a.length,"/255"]}),Object(W.jsxs)("div",{children:[Object(W.jsx)("button",{type:"button",id:"cancel-edit-comment",onClick:()=>s(!1),children:"cancel"}),Object(W.jsx)("button",{type:"submit",id:"submit-edit-comment",style:{color:"var(--color-purple)",cursor:l.length?"not-allowed":"pointer"},children:"submit"})]})]})]})};function $(e){let{post:t,comment:s}=e;const n=Object(o.useDispatch)();let a=Object(o.useSelector)((e=>e.session.user));const[i,l]=Object(c.useState)(!1),[r,d]=Object(c.useState)(!1),[j,u]=Object(c.useState)(+s.timeElapsed.split(" ")[0]+1);Object(c.useEffect)((()=>{let e;if(59!==j)return(s.timeElapsed.endsWith("seconds ago")||s.timeElapsed.endsWith("second ago"))&&(e=setTimeout((()=>u((e=>e+1))),1e3),s.timeElapsed="".concat(j+1," seconds ago")),()=>clearTimeout(e);e=setTimeout((()=>{s.timeElapsed="1 minute ago",u(60)}),1e3)}),[s,j]);return Object(W.jsxs)("div",{className:"comment-container",onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[Object(W.jsx)("div",{style:{width:"30px",height:"30px",minWidth:"30px",minHeight:"30px"},onClick:e=>{window.location.reload(!1)},children:Object(W.jsx)(Z,{user:s.user})}),Object(W.jsx)("div",{className:"comment-body",children:i?Object(W.jsx)(X,{comment:s,setShowEdit:l}):Object(W.jsxs)("div",{className:"handle-and-comment-content",children:[Object(W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(W.jsx)("span",{className:"comment-user-handle",children:s.user.handle}),Object(W.jsx)("span",{style:{color:"var(--color-gray)"},children:s.timeElapsed})]}),Object(W.jsx)("span",{className:"comment-text",children:s.content})]})}),s.user.id===a.id&&r&&Object(W.jsxs)("div",{className:"edit-and-delete-buttons",children:[Object(W.jsx)(G.a,{icon:V.c,id:"edit-comment-button",onClick:()=>l(!i)}),Object(W.jsx)(G.a,{icon:V.k,id:"delete-comment-button",onClick:()=>{return e=s.id,void(window.confirm("Are you sure you would like to delete your comment?")&&n(z(e,t.id)));var e}})]})]})}s(95);var ee=function(e){let{postId:t}=e;const s=Object(o.useDispatch)(),[n,a]=Object(c.useState)(""),[i,l]=Object(c.useState)(!1),[r,d]=Object(c.useState)([]);return Object(c.useEffect)((()=>{const e=[];n.length||e.push("!content"),n.length>255&&e.push("content>255"),d(e)}),[n]),Object(W.jsx)("div",{id:"comment-form-wrapper",children:Object(W.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),r.length)return;s((e=>async t=>{const s=await fetch("/api/posts/".concat(e.postId,"/comments/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t(R(e)),e}})({content:n,postId:t})).then((e=>{a("");document.querySelector(".comment-section").scrollTop=0})).catch((async e=>{const t=await e.json();t&&t.errors&&d(t.errors)}))},onFocus:()=>l(!0),onBlur:()=>l(!1),children:[Object(W.jsx)("input",{id:"comment-input",name:"content",value:n,onChange:e=>a(e.target.value),placeholder:"add a comment",autoComplete:"off"}),Object(W.jsx)("button",{type:"submit",id:"comment-submit",style:{cursor:r.length?"not-allowed":"pointer"},children:"post"}),i&&Object(W.jsxs)("small",{style:n.length>255||0===n.length?{color:"red"}:{},children:[n.length,"/255"]})]})})};s(96);var te=function(e){let{post:t,setEditCaption:s}=e;const n=Object(o.useDispatch)(),[a,i]=Object(c.useState)(t.caption),[l,r]=Object(c.useState)([]);return Object(c.useEffect)((()=>{const e=[];a.length>255&&e.push("Caption must be 255 characters or less"),r(e)}),[a]),Object(W.jsx)("div",{children:Object(W.jsxs)("form",{method:"POST",action:"/posts",onSubmit:e=>{if(e.preventDefault(),l.length)return;const c={id:t.id,caption:a};n((e=>async t=>{const s=await fetch("/api/posts/".concat(e.id,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t(A(e)),e}})(c)).then((e=>{s(!1)})).catch((async e=>{console.log(e);const t=e;t&&t.errors&&r(t.errors)}))},children:[Object(W.jsx)("textarea",{id:"caption-input",name:"caption",value:a,style:a.length>255?{borderColor:"red"}:{},onChange:e=>i(e.target.value)}),Object(W.jsxs)("div",{id:"edit-caption-lower",children:[Object(W.jsxs)("small",{style:a.length>255?{color:"red"}:{},children:[a.length,"/255"]}),Object(W.jsxs)("div",{id:"edit-post-button-container",children:[Object(W.jsx)("button",{type:"button",id:"cancel-caption-button",onClick:()=>s(!1),children:"Cancel"}),Object(W.jsx)("button",{type:"submit",id:"save-caption-button",style:{cursor:l.length?"not-allowed":"pointer"},children:"Save"})]})]})]})})};s(97);function se(e){let{postId:t,setShowModal:s}=e;const n=Object(o.useDispatch)(),a=Object(r.g)();let i=Object(o.useSelector)((e=>e.posts[t])),l=Object(o.useSelector)((e=>e.session.user));const[d,j]=Object(c.useState)(Object.values(null===i||void 0===i?void 0:i.postLikes)),[u,b]=Object(c.useState)(Object.values(null===i||void 0===i?void 0:i.comments)),[h,p]=Object(c.useState)(!!d.find((e=>e.userId===l.id))),[m,O]=Object(c.useState)(!1),[f,g]=Object(c.useState)(+(null===i||void 0===i?void 0:i.timeElapsed.split(" ")[0])+1);Object(c.useEffect)((()=>{b((()=>v(Object.values(i.comments))))}),[i.comments]),Object(c.useEffect)((()=>{j((()=>Object.values(i.postLikes))),p((()=>!!Object.values(i.postLikes).find((e=>e.userId===l.id))))}),[i.postLikes]);Object(c.useEffect)((()=>{let e;if(59!==f)return(i.timeElapsed.endsWith("seconds ago")||i.timeElapsed.endsWith("second ago"))&&(e=setTimeout((()=>g((e=>e+1))),1e3),i.timeElapsed="".concat(f+1," seconds ago")),()=>clearTimeout(e);e=setTimeout((()=>{i.timeElapsed="1 minute ago",g(60)}),1e3)}),[i,f]);const x=async()=>{await n(B(t))};return Object(W.jsxs)("div",{className:"post-modal-wrapper",children:[Object(W.jsx)("div",{className:"post-image-wrapper",children:Object(W.jsx)("img",{src:i.postImageUrl,alt:"post"})}),Object(W.jsxs)("div",{className:"post-modal__right",children:[Object(W.jsx)("div",{id:"post-info",children:Object(W.jsxs)("div",{className:"post-header",children:[Object(W.jsx)("div",{className:"post-icon",style:{minWidth:"50px",width:"50px",height:"50px"},children:Object(W.jsx)(Z,{user:i.user})}),Object(W.jsxs)("div",{className:"post-details-container",children:[Object(W.jsxs)("div",{className:"post-details",children:[Object(W.jsx)("h4",{className:"post-user-handle",children:i.user.handle}),m?Object(W.jsx)(te,{post:i,setEditCaption:O}):Object(W.jsx)("span",{className:"post-caption",children:i.caption})]}),l.id!==i.user.id?null:Object(W.jsxs)("div",{className:"post-buttons",children:[Object(W.jsx)(G.a,{id:"",icon:V.c,onClick:()=>O(!m)}),Object(W.jsx)(G.a,{icon:V.k,onClick:()=>(async()=>{if(window.confirm("Are you sure you want to delete your post?"))return s(!1),await n(q(i.id)),a.push("/")})()})]})]})]})}),Object(W.jsx)("div",{className:"comment-section",children:u.length>0?Object(W.jsx)(W.Fragment,{children:u.map((e=>Object(W.jsx)("div",{className:"single-comment",children:Object(W.jsx)($,{post:i,comment:e})},e.id)))}):Object(W.jsx)("span",{style:{color:"var(--color-gray)",fontSize:"14px"},children:"Be the first to leave a comment!"})}),Object(W.jsxs)("div",{id:"likes-div",children:[Object(W.jsxs)("div",{id:"likes-div-icons",children:[h?Object(W.jsx)(G.a,{icon:V.f,id:"like-button",style:{fontSize:"20px",color:"var(--color-red)",cursor:"pointer"},onClick:x}):Object(W.jsx)(G.a,{icon:K.b,id:"like-button",style:{fontSize:"20px",cursor:"pointer"},onClick:x}),Object(W.jsx)(G.a,{icon:K.a,id:"comment-icon",style:{fontSize:"20px"}})]}),Object(W.jsxs)("span",{id:"post-like-count",children:[d.length," ",1===(null===d||void 0===d?void 0:d.length)?"like":"likes"]}),Object(W.jsx)("small",{id:"date-posted",style:{color:"var(--color-gray)",fontSize:"12px"},children:i.timeElapsed})]}),Object(W.jsx)("div",{id:"create-comment",children:Object(W.jsx)(ee,{postId:t})})]})]})}function ce(e){let{postImageRef:t,post:s,isSearchItem:n}=e;const[a,i]=Object(c.useState)(!1),o=Object(r.g)();Object(c.useEffect)((()=>{const e=document.getElementById("navbar"),t=document.getElementById("nav-background"),s=document.getElementById("footer"),c=document.getElementById("footer-background"),n=document.getElementById("all-posts"),i=document.getElementById("profile-page");return a&&(e.classList.add("blur"),t.classList.remove("hidden"),s.classList.add("blur"),c.classList.remove("hidden"),null===n||void 0===n||n.classList.add("blur"),null===i||void 0===i||i.classList.add("blur")),()=>{e.classList.remove("blur"),t.classList.add("hidden"),s.classList.remove("blur"),c.classList.add("hidden"),null===n||void 0===n||n.classList.remove("blur"),null===i||void 0===i||i.classList.remove("blur")}}),[a]);return Object(W.jsxs)(W.Fragment,{children:[n?Object(W.jsxs)("span",{onClick:e=>{o.push("/".concat(s.user.handle),{modalId:s.id}),window.location.reload()},className:"search-item",children:[Object(W.jsx)(G.a,{icon:V.h,style:{color:"var(--color-dark-gray)"}}),Object(W.jsxs)("div",{className:"item-details",children:[Object(W.jsx)("span",{children:s.caption}),Object(W.jsx)("small",{children:s.user.handle})]})]}):Object(W.jsx)("img",{src:s.postImageUrl,id:"post-image",ref:t,alt:"".concat(s.user.handle,"'s avatar"),onClick:()=>i(!0)}),a&&Object(W.jsx)(Y,{closeModal:()=>i(!1),children:Object(W.jsx)(se,{postId:s.id,setShowModal:i})})]})}s(52);function ne(e){let{post:t}=e;const s=Object(o.useDispatch)(),n=Object(o.useSelector)((e=>e.session.user)),[a,i]=Object(c.useState)(Object.values(t.postLikes)),[l,r]=Object(c.useState)(!!a.find((e=>e.userId===n.id))),[d,j]=Object(c.useState)(Object.values(t.comments));Object(c.useEffect)((()=>{i((()=>Object.values(t.postLikes))),r((()=>!!Object.values(t.postLikes).find((e=>e.userId===n.id))))}),[t.postLikes]),Object(c.useEffect)((()=>{j(v(Object.values(t.comments)))}),[t.comments]);const u=async e=>{await s(B(t.id))};return Object(W.jsxs)("div",{className:"single-feed-post",children:[Object(W.jsx)("div",{className:"post-image-div",children:Object(W.jsx)(ce,{post:t})}),Object(W.jsxs)("div",{className:"post-info",children:[Object(W.jsxs)("div",{className:"user-image-and-handle",children:[Object(W.jsx)("div",{style:{width:"40px",height:"40px"},children:Object(W.jsx)(Z,{user:t.user})}),Object(W.jsx)("span",{className:"user-handle",children:t.user.handle})]}),Object(W.jsxs)("div",{className:"post-like-and-comment-count",children:[l?Object(W.jsxs)("span",{onClick:u,children:[Object(W.jsx)(G.a,{icon:V.f,className:"like-icon"}),a.length]}):Object(W.jsxs)("span",{onClick:u,children:[Object(W.jsx)(G.a,{icon:K.b,className:"like-icon"}),a.length]}),Object(W.jsxs)("span",{children:[Object(W.jsx)(G.a,{style:{cursor:"default"},icon:K.a,className:"comment-icon"}),d.length]})]})]})]},t.id)}var ae=function(e){let{column:t}=e;return Object(W.jsx)("div",{className:"posts-list",children:t.map((e=>Object(W.jsx)(ne,{post:e},e.id)))})},ie=s.p+"static/media/loading-sphere-colorbg.cf2833c4.gif";s(98);function oe(){return Object(W.jsxs)("div",{id:"loading-spinner-container",children:[Object(W.jsx)("img",{src:ie,alt:"loading-spinner",id:"loading-spinner"}),Object(W.jsx)("h4",{children:"please wait while we load your page..."})]})}var le=s.p+"static/media/feed-empty-1.20b5a593.jpg",re=s.p+"static/media/feed-empty-2.8f702fa5.jpg",de=s.p+"static/media/feed-empty-3.361cfde1.jpg";var je=function(){const e=Object(o.useDispatch)(),[t,s]=Object(c.useState)(!1),[n,a]=Object(c.useState)(2);let i=Object(o.useSelector)((e=>e.posts));const[l,r]=Object(c.useState)([]);Object(c.useEffect)((()=>{(async()=>{await e(F("feed",null)),s((()=>!0))})()}),[e]),Object(c.useEffect)((()=>{r((()=>v(Object.values(i))))}),[i]);const d=[],j=[],u=[];let b=0;for(let c of l)switch(b){case 0:d.push(c),b++;continue;case 1:j.push(c),b++;continue;case 2:u.push(c),b=0;continue;default:console.error("COULDN'T PROPERLY ASSIGN POSTS")}return Object(c.useEffect)((()=>{const t=async()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight+100&&(window.removeEventListener("scroll",t),await e(F("feed",null,n)),a((e=>e+1)))};return window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}}),[n]),t?Object(W.jsx)("div",{children:Object.values(i).length>0?Object(W.jsxs)("div",{id:"all-posts",children:[Object(W.jsx)(ae,{column:d}),Object(W.jsx)(ae,{column:j}),Object(W.jsx)(ae,{column:u})]}):Object(W.jsxs)("div",{id:"empty-feed",children:[Object(W.jsxs)("div",{className:"empty-feed-header",children:[Object(W.jsx)("h2",{className:"no-feed-posts",style:{fontWeight:"bolder",fontSize:"25px",letterSpacing:"4px",fontStyle:"italic"},children:"welcome to hologram"}),Object(W.jsx)("h4",{className:"no-feed-posts",style:{fontSize:"16px"},children:"follow people to start seeing the photos they share"})]}),Object(W.jsx)("img",{src:le,alt:"friends"}),Object(W.jsx)("img",{src:de,alt:"friends"}),Object(W.jsx)("img",{src:re,alt:"friends"})]})}):Object(W.jsx)(oe,{})},ue=(s(53),s(26));const be="session/LOAD_SEARCH",he=e=>({type:be,results:e}),pe=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async s=>{let c;if(c=t?await fetch("/api/search/users/".concat(e,"/")):await fetch("/api/search/".concat(e,"/")),c.ok){const e=await c.json();return s(he(e)),e}}};var me=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case be:return[...e,...t.results];default:return e}};const Oe={includeScore:!0,findAllMatches:!0,useExtendedSearch:!0,keys:[{name:"handle",weight:2},{name:"firstName",weight:1.5},{name:"lastName",weight:1},{name:"caption",weight:.5}]};function fe(){const e=Object(o.useDispatch)(),t=Object(r.g)(),s=Object(c.useRef)(),n=Object(c.useRef)(),[a,i]=Object(c.useState)(""),[l,d]=Object(c.useState)([]),[j,u]=Object(c.useState)(!1);Object(c.useEffect)((()=>{if(!a)return;let t;return t=setTimeout((async()=>{const t=await e(pe(a));if(t.length){const e=new Set,s=new Set;l.forEach((t=>{var c,n;void 0!==(null===t||void 0===t||null===(c=t.item)||void 0===c?void 0:c.caption)&&e.add(t.item.id),void 0!==(null===t||void 0===t||null===(n=t.item)||void 0===n?void 0:n.handle)&&s.add(t.item.id)}));const c=t.filter((t=>void 0!==(null===t||void 0===t?void 0:t.caption)&&!e.has(t.id)||(void 0!==(null===t||void 0===t?void 0:t.handle)&&!s.has(t.id)||void 0)));d((e=>new ue.a(c,Oe).search(a)))}}),300),()=>clearTimeout(t)}),[a]);const b=()=>{document.querySelector(".search"),u(!0)};Object(c.useEffect)((()=>{if(!j)return;const e=document.getElementById("portal"),t=t=>{var c,a;s.current&&((null===(c=s.current)||void 0===c?void 0:c.contains(t.target))||e.contains(t.target)||t.target===n.current?(null===(a=s.current)||void 0===a?void 0:a.contains(t.target))&&(s.current.style.display="none"):(s.current.style.display="flex",document.querySelector(".search"),u((()=>!j))))};return document.addEventListener("click",t),()=>{u(!1),document.removeEventListener("click",t)}}),[j]);return Object(W.jsxs)("div",{className:"search",children:[Object(W.jsxs)("form",{className:"search__form",onSubmit:e=>{e.preventDefault(),a&&u(!1)},children:[Object(W.jsx)("input",{type:"text",placeholder:"search users or posts",className:"",value:a,onChange:e=>i(e.target.value.replace(/[^a-zA-Z0-9\.\-\s]/g,"")),onClick:b,onKeyPress:b,ref:n}),Object(W.jsx)(G.a,{icon:V.j,style:{color:"var(--color-dark-gray)"}})]}),j&&Object(W.jsxs)("div",{className:"search-filter",ref:s,children:[l.length?null:Object(W.jsx)("div",{id:"search-message",children:"No results to show"}),l.slice(0,20).map(((e,s)=>{var c,n;return(null===(c=e.item)||void 0===c?void 0:c.hasOwnProperty("handle"))?Object(W.jsxs)("span",{onClick:()=>{return s=e.item.handle,t.push("/".concat(s)),void window.location.reload(!1);var s},className:"search-item",children:[Object(W.jsx)(G.a,{icon:V.l,style:{color:"var(--color-dark-gray)"}}),Object(W.jsxs)("div",{className:"item-details",children:[Object(W.jsx)("span",{className:"line-clamp",style:{fontSize:"16px"},children:e.item.handle}),Object(W.jsxs)("small",{children:[e.item.firstName," ",e.item.lastName]})]})]},s):(null===(n=e.item)||void 0===n?void 0:n.hasOwnProperty("caption"))?Object(W.jsx)(ce,{isSearchItem:!0,post:e.item},s):void 0}))]})]})}s(99),s(100);function ge(e){let{user:t}=e;const s=Object(o.useDispatch)(),n=Object(r.g)(),[a,i]=Object(c.useState)(!1);Object(c.useEffect)((()=>{if(!a)return;const e=()=>{document.querySelector(".nav-profile-button"),i(!1)};return document.addEventListener("click",e),()=>{i(!1),document.removeEventListener("click",e)}}),[a]);return Object(W.jsxs)("div",{className:"nav-profile-button",onClick:()=>{a||(document.querySelector(".nav-profile-button"),i(!0))},children:[Object(W.jsx)("img",{src:"/default-profile-image.png"!==t.profileImageUrl?t.profileImageUrl:Q,alt:"profile preview"}),a&&Object(W.jsxs)("div",{className:"profile_nav_dropdown",children:[Object(W.jsx)("div",{children:Object(W.jsx)("button",{id:"temp",onClick:()=>{window.scrollTo(0,0),n.push("/".concat(t.handle)),window.location.reload(!1)},style:{border:"none",backgroundColor:"transparent",padding:"2px"},children:Object(W.jsxs)("p",{style:{letterSpacing:"1px",fontSize:"14.5px"},children:["profile\xa0\xa0",Object(W.jsx)(G.a,{icon:V.l})]})})}),Object(W.jsx)("div",{children:Object(W.jsxs)(l.c,{to:"/users/settings",onClick:()=>window.scrollTo(0,0),style:{width:"100%"},children:["settings\xa0\xa0",Object(W.jsx)(G.a,{icon:V.e})]})}),Object(W.jsxs)("div",{onClick:e=>{i(!1),window.confirm("Are you sure you want to log out?")&&(s(m()),window.scrollTo({top:0,left:0,behavior:"smooth"}),n.push("/login"))},children:["log out\xa0\xa0",Object(W.jsx)(G.a,{icon:V.a})]})]})]})}var xe=s.p+"static/media/hologram-logo.257a8c2c.png";s(101);var ve=e=>{let{follows:t}=e;const s=Object(r.g)();return Object(W.jsx)(W.Fragment,{children:t.map((e=>Object(W.jsx)("button",{onClick:()=>{window.scroll(0,0),s.push("/".concat(e.handle)),window.location.reload(!1)},style:{border:"none",backgroundColor:"white"},children:Object(W.jsxs)("div",{className:"selected-dropdown-user",children:[Object(W.jsx)("div",{className:"user-profile-avatar",children:Object(W.jsx)("img",{className:"follows-avatar-image",src:"/default-profile-image.png"!==e.profileImageUrl?e.profileImageUrl:Q,alt:"preview"})}),Object(W.jsxs)("div",{className:"justify-left",children:[Object(W.jsxs)("p",{className:"follows-name",children:[e.firstName," ",e.lastName]}),Object(W.jsx)("p",{className:"follows-handle",children:e.handle})]})]})},e.id)))})};var we=()=>{const e=Object(o.useSelector)((e=>e.session.user)),[t,s]=Object(c.useState)(!1),[n,a]=Object(c.useState)(!1);Object(c.useEffect)((()=>{if(!t)return;const e=()=>{document.querySelector(".sessionUser-followers"),s(!1)};return document.addEventListener("click",e),()=>{s(!1),document.removeEventListener("click",e)}}),[t]);return Object(c.useEffect)((()=>{if(!n)return;const e=()=>{document.querySelector(".sessionUser-followings"),a(!1)};return document.addEventListener("click",e),()=>{a(!1),document.removeEventListener("click",e)}}),[n]),e?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{id:"nav-background",className:"hidden"}),Object(W.jsx)("div",{id:"navbar",children:Object(W.jsxs)("div",{className:"navbar-container",children:[Object(W.jsx)("div",{className:"nav__left",children:Object(W.jsx)(l.b,{to:"/",children:Object(W.jsxs)("div",{className:"logo-wrapper",children:[Object(W.jsx)("img",{src:xe,alt:"logo",className:"nav__logo"}),Object(W.jsxs)("h1",{children:[Object(W.jsx)("span",{style:{color:"var(--color-purple)"},children:"holo"}),Object(W.jsx)("span",{style:{color:"rgb(215, 155, 134)"},children:"gram"})]})]})})}),Object(W.jsx)("div",{className:"search-bar",children:Object(W.jsx)(fe,{})}),Object(W.jsxs)("div",{className:"nav__right",children:[Object(W.jsxs)("div",{className:"nav__buttons",children:[Object(W.jsx)(l.b,{to:"/",children:Object(W.jsx)(G.a,{icon:V.g,className:"nav__icon"})}),Object(W.jsx)(l.b,{to:"/posts/new",children:Object(W.jsx)(G.a,{icon:V.b,className:"nav__icon"})}),Object(W.jsx)(l.b,{to:"/messages",children:Object(W.jsx)(G.a,{icon:V.d,className:"nav__icon"})})]}),Object(W.jsxs)("div",{className:"nav__stats",children:[Object(W.jsxs)("div",{className:"sessionUser-followers",children:[(null===e||void 0===e?void 0:e.followers.length)?Object(W.jsxs)("button",{className:"remove-button-styling stack add-hover ",type:"button",onClick:()=>{t||(document.querySelector(".sessionUser-followers"),s(!0))},children:[Object(W.jsx)("span",{children:null===e||void 0===e?void 0:e.followers.length}),Object(W.jsx)("small",{children:"followers"})]}):Object(W.jsxs)("button",{className:"remove-button-styling stack",type:"button",style:{cursor:"default"},children:[Object(W.jsx)("span",{children:null===e||void 0===e?void 0:e.followers.length}),Object(W.jsx)("small",{children:"followers"})]}),t&&Object(W.jsx)("div",{className:"follows-dropdown",children:Object(W.jsx)("div",{className:"followers-list",children:Object(W.jsx)(ve,{follows:null===e||void 0===e?void 0:e.followers})})})]}),Object(W.jsxs)("div",{className:"sessionUser-followings",children:[(null===e||void 0===e?void 0:e.following.length)?Object(W.jsxs)("button",{className:"remove-button-styling stack add-hover",type:"button",onClick:()=>{n||(document.querySelector(".sessionUser-following"),a(!0))},children:[Object(W.jsx)("span",{children:null===e||void 0===e?void 0:e.following.length}),Object(W.jsx)("small",{children:"following"})]}):Object(W.jsxs)("button",{className:"remove-button-styling stack",type:"button",style:{cursor:"default"},children:[Object(W.jsx)("span",{children:null===e||void 0===e?void 0:e.following.length}),Object(W.jsx)("small",{children:"following"})]}),n&&Object(W.jsx)("div",{className:"follows-dropdown",children:Object(W.jsx)("div",{className:"followings-list",children:Object(W.jsx)(ve,{follows:null===e||void 0===e?void 0:e.following})})})]})]}),Object(W.jsx)(ge,{user:e})]})]})})]}):null},ye=s(20);s(102);function Ne(){const[e,t]=Object(c.useState)(!0);return e?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{id:"footer-background",className:"hidden"}),Object(W.jsxs)("footer",{id:"footer",children:[Object(W.jsx)("div",{id:"information-button",children:Object(W.jsx)("button",{id:"change",type:"button",onClick:()=>t(!e),children:"i"})}),Object(W.jsx)("div",{id:"languages",children:Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:["Madi Lippmann",Object(W.jsx)("a",{href:"https://github.com/madilippmann",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.a,className:"link-logo"})}),Object(W.jsx)("a",{href:"https://www.linkedin.com/in/madilippmann/",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.b,className:"link-logo"})})]}),Object(W.jsxs)("li",{children:["Nick Esqueda",Object(W.jsx)("a",{href:"https://github.com/nick-esqueda",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.a,className:"link-logo"})}),Object(W.jsx)("a",{href:"https://www.linkedin.com/in/nick-esqueda/",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.b,className:"link-logo"})})]}),Object(W.jsxs)("li",{children:["Kevin Pravia Mayorga",Object(W.jsx)("a",{href:"https://github.com/reversalbino",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.a,className:"link-logo"})}),Object(W.jsx)("a",{href:"https://www.linkedin.com/in/kevin-pravia-mayorga-51380817a",target:"_blank",rel:"noreferrer",children:Object(W.jsx)(G.a,{icon:ye.b,className:"link-logo"})})]})]})})]})]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{id:"footer-background",className:"hidden"}),Object(W.jsxs)("footer",{id:"footer",children:[Object(W.jsx)("div",{id:"information-button",children:Object(W.jsx)("button",{id:"change",type:"button",onClick:()=>t(!e),children:"i"})}),Object(W.jsx)("div",{id:"languages",children:Object(W.jsxs)("ul",{children:[Object(W.jsx)("li",{children:"React"}),Object(W.jsx)("li",{children:"Redux"}),Object(W.jsx)("li",{children:"Python"}),Object(W.jsx)("li",{children:"Flask"}),Object(W.jsx)("li",{children:"PostgreSQL"}),Object(W.jsx)("li",{children:"SQLAlchemy"}),Object(W.jsx)("li",{children:"Heroku"}),Object(W.jsx)("li",{children:"AWS"}),Object(W.jsx)("li",{children:"HTML"}),Object(W.jsx)("li",{children:"CSS"})]})})]})]})}function Se(e){let{children:t}=e;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(we,{}),t,Object(W.jsx)(Ne,{})]})}s(103);function ke(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(""),[a,i]=Object(c.useState)(""),[d,j]=Object(c.useState)(""),[u,h]=Object(c.useState)(""),[p,m]=Object(c.useState)(""),[O,f]=Object(c.useState)(""),g=Object(o.useSelector)((e=>e.session.user)),x=Object(o.useDispatch)();Object(c.useEffect)((()=>(document.body.classList.add("body"),()=>{document.body.classList.remove("body")})),[]);return g?Object(W.jsx)(r.a,{to:"/"}):Object(W.jsx)("div",{className:"signup-login-container",children:Object(W.jsx)("div",{className:"signup-login-form-container",children:Object(W.jsxs)("form",{className:"signup-login-form",onSubmit:async e=>{if(e.preventDefault(),p===O){const e=await x(((e,t,s,c,n)=>async a=>{const i=await fetch("/api/auth/signup/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e,lastName:t,handle:s,email:c,password:n})});if(i.ok){const e=await i.json();return a(b(e)),a(b(e)),null}if(!(i.status<500))return["An error occurred. Please try again."];{const e=await i.json();if(e.errors)return e.errors}})(s,a,d,u,p));e&&t(e)}else t((()=>[": Passwords do not match"]))},children:[Object(W.jsxs)("div",{className:"logo-title-container",children:[Object(W.jsx)("img",{id:"signup-login-logo",src:xe,alt:"HOLOGRAM logo"}),Object(W.jsxs)("h1",{children:[Object(W.jsx)("span",{style:{color:"var(--color-purple)"},children:"holo"}),Object(W.jsx)("span",{style:{color:"rgb(215, 155, 134)"},children:"gram"})]})]}),Object(W.jsx)("div",{children:e.map(((e,t)=>Object(W.jsx)("div",{className:"error-styling",children:e.split(": ")[1]},t)))}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"text",name:"firstName",onChange:e=>{n(e.target.value)},value:s,className:"signup-login-input",placeholder:"first name"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"text",name:"handle",onChange:e=>{i(e.target.value)},value:a,className:"signup-login-input",placeholder:"last name",autoComplete:"new-password"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"text",name:"handle",onChange:e=>{j(e.target.value)},value:d,className:"signup-login-input",placeholder:"handle",autoComplete:"new-password"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"text",name:"email",onChange:e=>{h(e.target.value)},value:u,className:"signup-login-input",placeholder:"email",autoComplete:"new-password"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"password",name:"password",onChange:e=>{m(e.target.value)},value:p,className:"signup-login-input",placeholder:"password"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{type:"password",name:"repeat_password",onChange:e=>{f(e.target.value)},value:O,required:!0,className:"signup-login-input",placeholder:"confirm password"})}),Object(W.jsx)("button",{className:"signup-login-submit-button",type:"submit",children:"sign up"}),Object(W.jsx)("div",{className:"border-top",children:Object(W.jsx)(l.b,{to:"/login",children:Object(W.jsx)("p",{className:"login-link",children:"login"})})})]})})})}function Ee(){const[e,t]=Object(c.useState)([]),[s,n]=Object(c.useState)(""),[a,i]=Object(c.useState)(""),d=Object(o.useSelector)((e=>e.session.user)),j=Object(o.useDispatch)();Object(c.useEffect)((()=>(document.body.classList.add("body"),()=>{document.body.classList.remove("body")})),[]);if(d)return Object(W.jsx)(r.a,{to:"/"});return Object(W.jsx)("div",{className:"signup-login-container",children:Object(W.jsx)("div",{className:"signup-login-form-container",children:Object(W.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const c=await j(p(s,a));c&&t(c)},className:"signup-login-form",children:[Object(W.jsxs)("div",{className:"logo-title-container",children:[Object(W.jsx)("img",{id:"signup-login-logo",src:xe,alt:"HOLOGRAM logo"}),Object(W.jsxs)("h1",{children:[Object(W.jsx)("span",{style:{color:"var(--color-purple)"},children:"holo"}),Object(W.jsx)("span",{style:{color:"rgb(215, 155, 134)"},children:"gram"})]})]}),Object(W.jsx)("div",{children:e.map(((e,t)=>Object(W.jsx)("div",{className:"error-styling",children:e.split(": ")[1]},t)))}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{name:"email",type:"text",placeholder:"Email",value:s,className:"signup-login-input",onChange:e=>{n(e.target.value)},autoComplete:"new-password"})}),Object(W.jsx)("div",{className:"signup-login-input-container",children:Object(W.jsx)("input",{name:"password",type:"password",placeholder:"Password",value:a,className:"signup-login-input",onChange:e=>{i(e.target.value)}})}),Object(W.jsx)("button",{className:"signup-login-submit-button",type:"submit",children:"login"}),Object(W.jsxs)("div",{className:"demo-and-signup",children:[Object(W.jsx)(l.b,{to:"/sign-up",children:Object(W.jsx)("p",{className:"login-link",children:"sign up"})}),Object(W.jsx)("button",{className:"demo-user-button",type:"button",onClick:async()=>{await j(p("demo@aa.io","password"))},children:"demo"})]})]})})})}var Ie=e=>{const t=Object(o.useSelector)((e=>e.session.user));return Object(W.jsx)(r.b,{...e,children:t?e.children:Object(W.jsx)(r.a,{to:"/login"})})};function Ce(){return Object(W.jsx)("div",{children:"page not found"})}const Le="users/ADD_USER",_e="users/ADD_FOLLOW",Te="users/REMOVE_FOLLOW",De=e=>async t=>{const s=await fetch("/api/users/".concat(e,"/"));if(s.ok){const e=await s.json();return t((e=>({type:Le,user:e}))(e)),e}},Ue=e=>async t=>{const s=await fetch("/api/follow/",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return"deleted"===e.status?t((c=e.followerId,{type:Te,sessionId:c})):t({type:_e,sessionUser:e}),e}var c};var Ae=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Le:return t.user;case _e:{const s=Array.isArray(e.followers)?[...e.followers]:[];return{...e,followers:[t.sessionUser,...s]}}case Te:return e.followers.splice(e.followers.indexOf(e.followers.find((e=>e.userId===t.sessionId))),1),{...e,followers:[...e.followers]};default:return e}};s(104);function Pe(e){let{post:t}=e;const s=Object(o.useDispatch)(),n=Object(o.useSelector)((e=>e.session.user)),a=Object(c.useRef)(),[i,l]=Object(c.useState)(Object.values(t.postLikes)),[r,d]=Object(c.useState)(!!i.find((e=>e.userId===n.id)));Object(c.useEffect)((()=>{l((()=>Object.values(t.postLikes))),d((()=>!!Object.values(t.postLikes).find((e=>e.userId===n.id))))}),[t.postLikes]);return Object(W.jsxs)("div",{className:"post-div",children:[Object(W.jsxs)("div",{className:"overlay",children:[Object(W.jsx)("div",{id:"blur-overlay",className:"postId-".concat(t.id),onClick:e=>{e.currentTarget===e.target&&a.current.click()}}),Object(W.jsxs)("div",{className:"overlay__button-container",children:[Object(W.jsxs)("div",{className:"centering-container like-container",children:[Object(W.jsx)("button",{type:"button",onClick:e=>(async()=>{await s(B(t.id))})(t.id),className:"like-button",children:r?Object(W.jsx)(G.a,{icon:V.f,className:"like-icon"}):Object(W.jsx)(G.a,{icon:K.b,className:"like-icon"})}),Object(W.jsx)("span",{children:i.length})]}),Object(W.jsxs)("div",{className:"centering-container comment-container",onClick:e=>a.current.click(),children:[Object(W.jsx)(G.a,{icon:K.c,className:"profile__post__icon comment-icon"}),Object(W.jsx)("span",{children:Object.values(t.comments).length})]})]})]}),Object(W.jsx)(ce,{post:t,postImageRef:a})]},t.id)}var Me=function(){const{handle:e}=Object(r.h)(),t=Object(o.useDispatch)(),s=Object(r.g)(),n=Object(o.useSelector)((e=>e.session.user)),a=Object(o.useSelector)((e=>e.user));let i=Object(o.useSelector)((e=>e.posts));const[d,j]=Object(c.useState)(!1),[u,h]=Object(c.useState)(),[p,m]=Object(c.useState)(!1),[O,f]=Object(c.useState)(!1),[g,x]=Object(c.useState)([]);return Object(c.useEffect)((()=>{(async()=>{const s=await t(De(e));await t(F("profile",s.id)),h((()=>!!(null===n||void 0===n?void 0:n.following.find((e=>e.id===(null===s||void 0===s?void 0:s.id)))))),j(!0)})()}),[t]),Object(c.useEffect)((()=>{if(d&&s.location.state&&s.location.state.modalId){document.querySelector(".postId-".concat(s.location.state.modalId)).click()}}),[d]),Object(c.useEffect)((()=>{x((()=>v(Object.values(i))))}),[i]),Object(c.useEffect)((()=>{if(!p)return;const e=()=>{document.querySelector(".sessionUser-followers"),m(!1)};return document.addEventListener("click",e),()=>{m(!1),document.removeEventListener("click",e)}}),[p]),Object(c.useEffect)((()=>{if(!O)return;const e=()=>{document.querySelector(".sessionUser-followings"),f(!1)};return document.addEventListener("click",e),()=>{f(!1),document.removeEventListener("click",e)}}),[O]),a?d?Object(W.jsxs)("div",{id:"profile-page",children:[Object(W.jsxs)("div",{className:"profile-page user-header",children:[Object(W.jsx)("div",{className:"profile-picture-container",children:n.id===a.id?Object(W.jsx)("img",{className:"profile-picture",src:"/default-profile-image.png"!==a.profileImageUrl?a.profileImageUrl:Q,alt:"".concat(a.firstName,"'s profile preview"),onClick:()=>s.push("/users/settings"),style:{cursor:"pointer"}}):Object(W.jsx)("img",{className:"profile-picture",src:"/default-profile-image.png"!==a.profileImageUrl?a.profileImageUrl:Q,alt:"".concat(a.firstName,"'s profile preview")})}),Object(W.jsxs)("div",{className:"user-info-container flex-space-between ",children:[Object(W.jsxs)("div",{className:"handle-follow-options-div ",children:[Object(W.jsx)("h3",{className:"profile-page-handle",style:{display:"inline"},children:a.handle}),a.id!==n.id?Object(W.jsx)("button",{className:"follow-new-post-button remove-button-styling ".concat(u),type:"button",onClick:async()=>{var e;await t(Ue(a.id)),await t((e=n.handle,async t=>{const s=await fetch("/api/users/".concat(e,"/"));if(s.ok){const e=await s.json();return t(b(e)),e}})),h((()=>!u))},children:u?Object(W.jsx)("span",{children:"Unfollow"}):Object(W.jsx)("span",{children:"Follow"})}):Object(W.jsx)(l.b,{to:"/posts/new",children:Object(W.jsxs)("button",{type:"button",className:"follow-new-post-button true remove-button-styling different-padding",children:[Object(W.jsx)(G.a,{icon:V.i,style:{paddingLeft:"0",paddingRight:"10px"}}),"New Post"]})})]}),Object(W.jsxs)("div",{className:"posts-followers-following-div flex-gap flex",children:[Object(W.jsx)("div",{children:Object(W.jsx)("button",{type:"button",style:{cursor:"default",border:"none",backgroundColor:"transparent",paddingLeft:"0"},children:Object(W.jsxs)("p",{children:[Object(W.jsx)("span",{style:{fontSize:"18px"},children:g.length})," posts"]})})}),Object(W.jsxs)("div",{className:"sessionUser-followers",children:[a.followers.length?Object(W.jsx)("button",{className:"remove-button-styling stack",type:"button",onClick:()=>{p||(document.querySelector(".sessionUser-followers"),m(!0))},children:Object(W.jsxs)("p",{className:"follows-profile add-hover",children:[Object(W.jsx)("span",{style:{fontSize:"18px"},children:a.followers.length})," followers"]})}):Object(W.jsx)("button",{className:"remove-button-styling stack",type:"button",style:{cursor:"default"},children:Object(W.jsxs)("p",{children:[Object(W.jsx)("span",{style:{fontSize:"18px",cursor:"default"},children:a.followers.length})," followers"]})}),p&&Object(W.jsx)("div",{className:"follows-dropdown",children:Object(W.jsx)("div",{className:"followers-list",children:Object(W.jsx)(ve,{follows:null===a||void 0===a?void 0:a.followers})})})]}),Object(W.jsxs)("div",{className:"sessionUser-followings",children:[a.following.length?Object(W.jsx)("button",{className:"remove-button-styling stack",type:"button",onClick:()=>{O||(document.querySelector(".sessionUser-following"),f(!0))},children:Object(W.jsxs)("p",{className:"follows-profile add-hover",children:[Object(W.jsx)("span",{style:{fontSize:"18px"},children:a.following.length})," following"]})}):Object(W.jsx)("button",{className:"remove-button-styling stack",type:"button",style:{cursor:"default"},children:Object(W.jsxs)("p",{children:[Object(W.jsx)("span",{style:{fontSize:"18px"},children:a.following.length})," following"]})}),O&&Object(W.jsx)("div",{className:"follows-dropdown",children:Object(W.jsx)("div",{className:"followings-list",children:Object(W.jsx)(ve,{follows:null===a||void 0===a?void 0:a.following})})})]})]}),Object(W.jsxs)("div",{className:"name-bio-div",children:[Object(W.jsxs)("h4",{children:[a.firstName," ",a.lastName]}),Object(W.jsx)("p",{children:a.bio})]})]})]}),Object(W.jsxs)("div",{className:"post-image-div profile-page user-posts",children:[g.map((e=>Object(W.jsx)(Pe,{post:e},e.id))),0===g.length&&Object(W.jsx)("p",{className:"no-posts",children:"No posts to show"})]})]}):Object(W.jsx)(oe,{}):null};function Re(){const{query:e}=Object(r.h)();return Object(W.jsxs)("div",{children:["search for: ",e]})}s(105);var Fe=s(117);var qe=e=>{let{thread:t,messages:s,onSubmit:n,message:a,setMessage:i,disabled:l}=e;const r=Object(o.useSelector)((e=>e.session.user));return Object(c.useEffect)((()=>{const e=document.getElementById("messages-map");e.scrollTop=e.scrollHeight}),[s]),Object(W.jsxs)("div",{className:"messages-inner-container",children:[Object(W.jsx)("div",{className:"messages-header",children:Object(W.jsx)("h2",{className:"thread-name",children:t.threadName})}),Object(W.jsx)("div",{id:"messages-map",children:s.map((e=>Object(W.jsxs)("div",{id:"message-container",className:e.userId===r.id?"me":"friend",children:[Object(W.jsxs)("div",{className:"message__name-and-date",children:[e.userId!==r.id&&Object(W.jsx)("h4",{className:"message__name",children:e.user.firstName}),Object(W.jsx)("h6",{className:"message__date",children:w(e.createdAt)})]}),Object(W.jsxs)("div",{className:"message-and-avatar",children:[Object(W.jsx)("div",{className:"message__avatar",children:Object(W.jsx)("img",{src:"/default-profile-image.png"!==e.user.profileImageUrl?e.user.profileImageUrl:Q,alt:"profile preview"})}),Object(W.jsx)("p",{className:"message__content",children:e.content})]})]},e.id)))}),Object(W.jsx)("form",{onSubmit:n,className:"message-form",children:Object(W.jsxs)("div",{className:"input__container",children:[Object(W.jsx)("input",{type:"text",onChange:e=>i(e.target.value),value:a,placeholder:"start message..."}),Object(W.jsx)("button",{type:"submit",id:"message-submit",disabled:l,className:"".concat(l),style:l?{}:{cursor:"pointer"},children:Object(W.jsx)(Fe.a,{size:"25",id:"send-icon"})})]})})]})};const ze="messages/ADD_THREAD",Be="messages/LOAD_THREAD",He="messages/ADD_MESSAGE",We="messages/LOAD_THREAD_PREVIEWS",Je=e=>async t=>{const s=await fetch("/api/threads/".concat(e,"/"));if(s.ok){const e=await s.json();return t((e=>({type:Be,thread:e}))(e)),e}},Ge=e=>async t=>{const s=await fetch("/api/threads/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t({type:ze,thread:e}),e}},Ve=e=>async t=>{const s=await fetch("/api/threads/".concat(e.threadId,"/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return t((e=>({type:He,message:e}))(e)),e}},Ke=()=>async e=>{const t=await fetch("/api/threads/threadPreviews/");if(t.ok){const s=await t.json();return e((e=>({type:We,threadPreviews:e}))(s)),s}};var Ye=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{thread:{},threadPreviews:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ze:return{...e,thread:{...t.thread,users:{...k(t.thread.users)}}};case Be:return{...e,thread:{...t.thread,messages:[...t.thread.messages],users:{...k(t.thread.users)}}};case He:return{...e,thread:{...e.thread,messages:[t.message,...e.thread.messages]}};case We:return{...e,threadPreviews:t.threadPreviews};default:return e}};s(107),s(108);const Qe={includeScore:!0,findAllMatches:!0,useExtendedSearch:!0,keys:[{name:"handle",weight:.7},{name:"firstName",weight:.6},{name:"lastName",weight:.4}]};function Ze(e){let{userIds:t,setUserIds:s,setSelectedUsers:n}=e;const a=Object(o.useDispatch)(),i=Object(o.useSelector)((e=>e.session.user)),[l,r]=Object(c.useState)(""),[d,j]=Object(c.useState)([]),[u,b]=Object(c.useState)(!1);Object(c.useEffect)((()=>{if(!l)return;const e=new ue.a(d,Qe).search(l);let t;return j(e),d.length<20&&(t=setTimeout((async()=>{const e=await a(pe(l,!0)),t=new Set;d.forEach((e=>t.add(e.item.id)));const s=e.filter((e=>!t.has(e.id))),c=new ue.a(s,Qe).search(l);j((e=>c.concat(e)))}),300)),()=>clearTimeout(t)}),[l]);const h=()=>{document.querySelector(".search"),b(!0)};Object(c.useEffect)((()=>{if(!u)return;const e=()=>{document.querySelector(".search"),b((()=>!u))},t=document.getElementById("user-search-dropdown"),s=document.getElementById("user-search-input"),c=c=>{t.contains(c.target)?(r(""),e(),t.style.display="none"):t.contains(c.target)||c.target===s?c.target===s&&h():(t.style.display="flex",e())};return document.addEventListener("click",c),()=>{b(!1),document.removeEventListener("click",c)}}),[u]);const p=e=>{t.has(e.id)||e.id===i.id||(s((t=>t.add(e.id))),n((t=>[...t,e])),b(!1))};return Object(W.jsxs)("div",{className:"search user-search-wrapper",children:[Object(W.jsx)("form",{className:"search__form user-search",onSubmit:e=>{e.preventDefault(),d[0]&&p(d[0].item)},children:Object(W.jsx)("input",{type:"text",placeholder:"add user...",id:"user-search-input",autoComplete:"off",value:l,onChange:e=>r(e.target.value),onClick:h,onFocus:h,onKeyPress:h})}),u&&Object(W.jsxs)("div",{id:"user-search-dropdown",className:"search-filter user-search",children:[Object(W.jsxs)("div",{id:"search-message",children:['searching for "',l,'"...']}),d.slice(0,20).map(((e,t)=>Object(W.jsxs)("span",{onClick:()=>p(e.item),className:"search-item",children:[Object(W.jsx)("div",{style:{width:"42px",minWidth:"42px",height:"42px",maxHeight:"42px"},children:Object(W.jsx)(Z,{user:e.item})}),Object(W.jsxs)("div",{className:"item-details",children:[Object(W.jsx)("span",{children:e.item.handle}),Object(W.jsxs)("small",{children:[e.item.firstName," ",e.item.lastName]})]})]},t)))]})]})}var Xe=e=>{let{currThreadId:t,setCurrThreadId:s,threadPreviews:n}=e;const a=Object(o.useDispatch)(),i=Object(o.useSelector)((e=>e.session.user)),[l,r]=Object(c.useState)(new Set),[d,j]=Object(c.useState)([]),[u,b]=Object(c.useState)(""),[h,p]=Object(c.useState)(!1);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"new-message-thread",children:[Object(W.jsx)("div",{className:"user-search",children:Object(W.jsx)(Ze,{userIds:l,setUserIds:r,setSelectedUsers:j})}),Object(W.jsxs)("div",{id:"selected-users",children:[Object(W.jsx)("div",{className:"selected-users-map",children:d.length?Object(W.jsx)(W.Fragment,{children:d.map((e=>Object(W.jsxs)("span",{className:"selected-user",children:[e.handle," ",Object(W.jsx)(G.a,{icon:V.m,className:"x-button",onClick:()=>{return t=e.id,r((e=>(e.delete(t),e))),void j((e=>e.filter((e=>e.id!==t))));var t}})]},e.id)))}):Object(W.jsx)("span",{style:{fontSize:"14px",padding:"8px",color:h?"red":"gray"},children:h?u:"search for someone to start a conversation..."})}),Object(W.jsx)("button",{type:"button",className:"create-thread-button follow-new-post-button false remove-button-styling different-padding",onClick:async()=>{const e=d.map((e=>e.firstName));if(0===d.length)return b("Please select at least one user to start a thread with."),void p(!0);if(window.confirm("Create a thread with ".concat(e.join(", "),"?"))){const e=await a(Ge(Array.from(l)));await a(Ke()),s(e.id),r(new Set),j([]),window.location.reload(!1)}},children:"create thread"})]})]}),Object(W.jsx)("div",{className:"thread-previews-container",children:n.map(((e,c)=>{let n=e.users.length>2?["You"]:[];for(const t of e.users)t!==i.firstName&&n.push(t);return n=n.join(", "),Object(W.jsx)("button",{type:"button",onClick:()=>s(e.threadId),id:"".concat(e.threadId===t),children:Object(W.jsx)("div",{className:"thread-preview",children:e.numberOfUsers<3?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{className:"preview__avatar single",children:Object(W.jsx)("img",{src:"/default-profile-image.png"!==e.profileImage?e.profileImage:Q,alt:"user-avatar"})}),Object(W.jsxs)("div",{className:"thread-name-and-preview",children:[Object(W.jsx)("h4",{children:n}),Object(W.jsx)("span",{className:"line-clamp",children:e.preview})]})]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"preview__avatar group",children:[Object(W.jsx)("img",{src:"/default-profile-image.png"!==e.profileImage?e.profileImage:Q,alt:"user-avatar"}),Object(W.jsx)("div",{id:"circle1"}),Object(W.jsx)("div",{id:"circle2"})]}),Object(W.jsxs)("div",{className:"thread-name-and-preview move-left",children:[Object(W.jsx)("h4",{className:"line-clamp",children:n}),Object(W.jsx)("span",{className:"line-clamp",children:e.preview})]})]})},c)})}))})]})};s(109);const $e=s(58).a.connect();var et=()=>{const e=Object(o.useDispatch)(),t=Object(o.useSelector)((e=>e.threads.thread)),s=Object(o.useSelector)((e=>e.threads.threadPreviews)),n=Object(o.useSelector)((e=>e.session.user)),[a,i]=Object(c.useState)(0),[l,r]=Object(c.useState)(0),[d,j]=Object(c.useState)(""),[u,b]=Object(c.useState)([]),[h,p]=Object(c.useState)(!0),[m,O]=Object(c.useState)(!1);Object(c.useEffect)((()=>{(async()=>{const t=await e(Ke()),s=await e(Je(t[0].threadId));i((()=>t[0].threadId)),r((()=>t[0].threadId)),b(s.messages),O(!0)})()}),[e]),Object(c.useEffect)((()=>{m&&(async()=>{const t=await e(Je(a));b(t.messages)})()}),[a]);return Object(c.useEffect)((()=>($e.on("message",(e=>{b((t=>[...t,e]))})),()=>$e.disconnect())),[]),Object(c.useEffect)((()=>{$e.emit("on_leave",{handle:n.handle,room:l}),$e.emit("on_join",{handle:n.handle,room:a}),r(a)}),[a]),Object(c.useEffect)((()=>{0!==d.length&&d.length<=2e3?p((()=>!1)):p((()=>!0))}),[d]),m?Object(W.jsxs)("div",{id:"messages-page-container",children:[Object(W.jsx)("div",{id:"messages-sidebar",children:Object(W.jsx)(Xe,{currThreadId:a,setCurrThreadId:i,threadPreviews:s})}),Object(W.jsx)("div",{id:"messages-container",children:Object(W.jsx)(qe,{thread:t,messages:u,onSubmit:async t=>{t.preventDefault();let s={threadId:a,userId:n.id,content:d};s=await e(Ve(s)),s.room=a,$e.send(s),j((()=>""))},message:d,setMessage:j,disabled:h})})]}):Object(W.jsx)(oe,{})};s(114);var tt=function(){const e=Object(o.useDispatch)(),t=Object(r.g)(),s=Object(o.useSelector)((e=>e.session.user)),[n,a]=Object(c.useState)(s.firstName),[i,l]=Object(c.useState)(s.lastName),[d,j]=Object(c.useState)(s.bio||""),[u,h]=Object(c.useState)(null),[p,m]=Object(c.useState)([]),O="/default-profile-image.png"!==s.profileImageUrl?s.profileImageUrl:Q,[g,x]=Object(c.useState)(!1),v=async e=>{if(!e)return console.log("upload a file first");const t=new FormData;t.append("file",e);return(await f.a.post("/api/s3/upload/",t)).data};return g?Object(W.jsx)("div",{id:"updating",children:Object(W.jsx)(oe,{})}):Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)("form",{onSubmit:async c=>{if(c.preventDefault(),x(!0),p.length)return p(!0);let a;return a=u?{firstName:n,lastName:i,bio:d,userId:s.id,profileImageUrl:await v(u)}:{firstName:n,lastName:i,bio:d,userId:s.id,profileImageUrl:s.profileImageUrl},await e((e=>{let{firstName:t,lastName:s,bio:c,userId:n,profileImageUrl:a}=e;return async e=>{const i=await fetch("/api/users/".concat(n,"/"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:t,lastName:s,bio:c,profileImageUrl:a})});if(i.ok){const t=await i.json();return e(b(t)),t}}})(a)),x(!1),window.scrollTo({top:0,left:0,behavior:"smooth"}),t.push("/".concat(s.handle))},id:"settings-form",children:[Object(W.jsxs)("div",{id:"left",children:[Object(W.jsx)("p",{children:"Update profile image"}),Object(W.jsxs)("div",{id:"upload-and-preview-section",style:{display:"block"},children:[Object(W.jsx)("div",{id:"preview",style:{border:"none"},children:Object(W.jsx)("img",{src:u?URL.createObjectURL(u):O,alt:"preview",id:"image-preview"})}),Object(W.jsxs)("div",{id:"upload",children:[Object(W.jsx)("label",{htmlFor:"img",id:"select-file-button",children:"SELECT IMAGE"}),Object(W.jsx)("input",{type:"file",id:"img",name:"img",accept:"image/*",onChange:e=>h((()=>e.target.files[0])),hidden:!0})]})]}),Object(W.jsx)("div",{className:"error-container",children:p.map((e=>Object(W.jsx)("div",{children:e},e)))})]}),Object(W.jsxs)("div",{id:"update-page-input-fields",children:[Object(W.jsx)("p",{children:"Update information"}),Object(W.jsx)("br",{}),Object(W.jsx)("br",{}),Object(W.jsx)("label",{htmlFor:"new-first-name",children:"First Name"}),Object(W.jsx)("input",{type:"text",value:n,id:"new-first-name",onChange:e=>a(e.target.value)}),Object(W.jsx)("br",{}),Object(W.jsx)("label",{htmlFor:"new-last-name",children:"Last Name"}),Object(W.jsx)("input",{type:"text",value:i,id:"new-last-name",onChange:e=>l(e.target.value)}),Object(W.jsx)("br",{}),Object(W.jsx)("label",{htmlFor:"new-bio",children:"Bio"}),Object(W.jsx)("textarea",{value:d,id:"new-bio",onChange:e=>j(e.target.value)}),Object(W.jsx)("br",{}),Object(W.jsx)("button",{type:"submit",id:"update-button",children:"Update"})]})]})})};var st=function(){const[e,t]=Object(c.useState)(!1),s=Object(o.useDispatch)();return Object(c.useEffect)((()=>{(async()=>{await s((async e=>{const t=await fetch("/api/auth/",{headers:{"Content-Type":"application/json"}});if(t.ok){const s=await t.json();if(s.errors)return;e(b(s))}})),t(!0)})()}),[s]),e?Object(W.jsx)(l.a,{children:Object(W.jsx)(Se,{children:Object(W.jsxs)(r.d,{children:[Object(W.jsx)(r.b,{path:"/login",exact:!0,children:Object(W.jsx)(Ee,{})}),Object(W.jsx)(r.b,{path:"/sign-up",exact:!0,children:Object(W.jsx)(ke,{})}),Object(W.jsx)(Ie,{path:"/",exact:!0,children:Object(W.jsx)(je,{})}),Object(W.jsx)(Ie,{exact:!0,path:"/posts/new",children:Object(W.jsx)(J,{})}),Object(W.jsx)(Ie,{exact:!0,path:"/search/:query",children:Object(W.jsx)(Re,{})}),Object(W.jsx)(Ie,{path:"/messages",exact:!0,children:Object(W.jsx)(et,{})}),Object(W.jsx)(Ie,{path:"/:handle",exact:!0,children:Object(W.jsx)(Me,{})}),Object(W.jsx)(Ie,{path:"/users/settings",exact:!0,children:Object(W.jsx)(tt,{})}),Object(W.jsx)(r.b,{children:Object(W.jsx)(Ce,{})})]})})}):null},ct=s(34),nt=s(57);const at=Object(ct.b)({session:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return{user:t.payload};case j:return{user:null};case u:return{...e,session:t.payload};default:return e}},posts:H,user:Ae,threads:Ye,search:me,loadingBar:g.loadingBarReducer});let it;it=Object(ct.a)(nt.a);const ot=(e=>Object(ct.c)(at,e,it))();i.a.render(Object(W.jsx)(n.a.StrictMode,{children:Object(W.jsx)(o.Provider,{store:ot,children:Object(W.jsx)(st,{})})}),document.getElementById("root"))},51:function(e,t,s){},52:function(e,t,s){},53:function(e,t,s){},64:function(e,t,s){},88:function(e,t,s){},91:function(e,t,s){},92:function(e,t,s){},93:function(e,t,s){},94:function(e,t,s){},95:function(e,t,s){},96:function(e,t,s){},97:function(e,t,s){},98:function(e,t,s){},99:function(e,t,s){}},[[115,1,2]]]);
//# sourceMappingURL=main.d8216933.chunk.js.map